!function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{gfTr:function(e,i,r){"use strict";r.d(i,"a",function(){return y}),r.d(i,"b",function(){return w});var a=r("fXoL"),o=r("PqYM"),s=r("ofXK"),c=["fileSelector"];function l(e,t){if(1&e&&(a.Zb(0,"div",8),a.Mc(1),a.Yb()),2&e){var n=a.lc(2);a.Hb(1),a.Nc(n.dropZoneLabel)}}function u(e,t){if(1&e){var n=a.ac();a.Zb(0,"div"),a.Zb(1,"input",9),a.hc("click",function(e){return a.Dc(n),a.lc(2).openFileSelector(e)}),a.Yb(),a.Yb()}if(2&e){var i=a.lc(2);a.Hb(1),a.uc("value",i.browseBtnLabel),a.tc("className",i.browseBtnClassName)}}function d(e,t){if(1&e&&(a.Kc(0,l,2,1,"div",6),a.Kc(1,u,2,2,"div",7)),2&e){var n=a.lc();a.tc("ngIf",n.dropZoneLabel),a.Hb(1),a.tc("ngIf",n.showBrowseBtn)}}function b(e,t){}var m=function(e){return{openFileSelector:e}},p=function e(t,i){n(this,e),this.relativePath=t,this.fileEntry=i},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(){var e=function e(t){n(this,e),this.template=t};return e.\u0275fac=function(t){return new(t||e)(a.Tb(a.R))},e.\u0275dir=a.Ob({type:e,selectors:[["","ngx-file-drop-content-tmp",""]]}),e=function(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}([f("design:paramtypes",[a.R])],e)}(),g=function(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},v=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(){var e=function(){function e(t,i){var r=this;n(this,e),this.zone=t,this.renderer=i,this.accept="*",this.directory=!1,this.multiple=!0,this.dropZoneLabel="",this.dropZoneClassName="ngx-file-drop__drop-zone",this.useDragEnter=!1,this.contentClassName="ngx-file-drop__content",this.showBrowseBtn=!1,this.browseBtnClassName="btn btn-primary btn-xs ngx-file-drop__browse-btn",this.browseBtnLabel="Browse files",this.onFileDrop=new a.q,this.onFileOver=new a.q,this.onFileLeave=new a.q,this.isDraggingOverDropZone=!1,this.globalDraggingInProgress=!1,this.files=[],this.numOfActiveReadEntries=0,this.helperFormEl=null,this.fileInputPlaceholderEl=null,this.dropEventTimerSubscription=null,this._disabled=!1,this.openFileSelector=function(e){r.fileSelector&&r.fileSelector.nativeElement&&r.fileSelector.nativeElement.click()},this.globalDragStartListener=this.renderer.listen("document","dragstart",function(e){r.globalDraggingInProgress=!0}),this.globalDragEndListener=this.renderer.listen("document","dragend",function(e){r.globalDraggingInProgress=!1})}return t(e,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=null!=e&&""+e!="false"}},{key:"ngOnDestroy",value:function(){this.dropEventTimerSubscription&&(this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=null),this.globalDragStartListener(),this.globalDragEndListener(),this.files=[],this.helperFormEl=null,this.fileInputPlaceholderEl=null}},{key:"onDragOver",value:function(e){this.useDragEnter?this.preventAndStop(e):this.isDropzoneDisabled()||this.useDragEnter||(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(e)),this.preventAndStop(e))}},{key:"onDragEnter",value:function(e){!this.isDropzoneDisabled()&&this.useDragEnter&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(e)),this.preventAndStop(e))}},{key:"onDragLeave",value:function(e){this.isDropzoneDisabled()||(this.isDraggingOverDropZone&&(this.isDraggingOverDropZone=!1,this.onFileLeave.emit(e)),this.preventAndStop(e))}},{key:"dropFiles",value:function(e){var t;!this.isDropzoneDisabled()&&(this.isDraggingOverDropZone=!1,e.dataTransfer)&&(e.dataTransfer.dropEffect="copy",t=e.dataTransfer.items?e.dataTransfer.items:e.dataTransfer.files,this.preventAndStop(e),this.checkFiles(t))}},{key:"uploadFiles",value:function(e){!this.isDropzoneDisabled()&&e.target&&(this.checkFiles(e.target.files||[]),this.resetFileInput())}},{key:"checkFiles",value:function(e){for(var t=this,n=function(n){var i=e[n],r=null;if(t.canGetAsEntry(i)&&(r=i.webkitGetAsEntry()),r)if(r.isFile){var a=new p(r.name,r);t.addToQueue(a)}else r.isDirectory&&t.traverseFileTree(r,r.name);else if(i){var o={name:i.name,isDirectory:!1,isFile:!0,file:function(e){e(i)}},s=new p(o.name,o);t.addToQueue(s)}},i=0;i<e.length;i++)n(i);this.dropEventTimerSubscription&&this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=Object(o.a)(200,200).subscribe(function(){if(t.files.length>0&&0===t.numOfActiveReadEntries){var e=t.files;t.files=[],t.onFileDrop.emit(e)}})}},{key:"traverseFileTree",value:function(e,t){var n=this;if(e.isFile){var i=new p(t,e);this.files.push(i)}else{t+="/";var r=e.createReader(),a=[];!function i(){n.numOfActiveReadEntries++,r.readEntries(function(r){if(r.length)a=a.concat(r),i();else if(0===a.length){var o=new p(t,e);n.zone.run(function(){n.addToQueue(o)})}else for(var s=function(e){n.zone.run(function(){n.traverseFileTree(a[e],t+a[e].name)})},c=0;c<a.length;c++)s(c);n.numOfActiveReadEntries--})}()}}},{key:"resetFileInput",value:function(){if(this.fileSelector&&this.fileSelector.nativeElement){var e=this.fileSelector.nativeElement,t=e.parentElement,n=this.getHelperFormElement(),i=this.getFileInputPlaceholderElement();t!==n&&(this.renderer.insertBefore(t,i,e),this.renderer.appendChild(n,e),n.reset(),this.renderer.insertBefore(t,e,i),this.renderer.removeChild(t,i))}}},{key:"getHelperFormElement",value:function(){return this.helperFormEl||(this.helperFormEl=this.renderer.createElement("form")),this.helperFormEl}},{key:"getFileInputPlaceholderElement",value:function(){return this.fileInputPlaceholderEl||(this.fileInputPlaceholderEl=this.renderer.createElement("div")),this.fileInputPlaceholderEl}},{key:"canGetAsEntry",value:function(e){return!!e.webkitGetAsEntry}},{key:"isDropzoneDisabled",value:function(){return this.globalDraggingInProgress||this.disabled}},{key:"addToQueue",value:function(e){this.files.push(e)}},{key:"preventAndStop",value:function(e){e.stopPropagation(),e.preventDefault()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Tb(a.E),a.Tb(a.K))},e.\u0275cmp=a.Nb({type:e,selectors:[["ngx-file-drop"]],contentQueries:function(e,t,n){var i;(1&e&&a.Mb(n,h,1,a.R),2&e)&&(a.zc(i=a.ic())&&(t.contentTemplate=i.first))},viewQuery:function(e,t){var n;(1&e&&a.Tc(c,3),2&e)&&(a.zc(n=a.ic())&&(t.fileSelector=n.first))},inputs:{accept:"accept",directory:"directory",multiple:"multiple",dropZoneLabel:"dropZoneLabel",dropZoneClassName:"dropZoneClassName",useDragEnter:"useDragEnter",contentClassName:"contentClassName",showBrowseBtn:"showBrowseBtn",browseBtnClassName:"browseBtnClassName",browseBtnLabel:"browseBtnLabel",disabled:"disabled"},outputs:{onFileDrop:"onFileDrop",onFileOver:"onFileOver",onFileLeave:"onFileLeave"},decls:7,vars:15,consts:[[3,"className","drop","dragover","dragenter","dragleave"],[3,"className"],["type","file",1,"ngx-file-drop__file-input",3,"accept","multiple","change"],["fileSelector",""],["defaultContentTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ngx-file-drop__drop-zone-label",4,"ngIf"],[4,"ngIf"],[1,"ngx-file-drop__drop-zone-label"],["type","button",3,"className","value","click"]],template:function(e,t){if(1&e&&(a.Zb(0,"div",0),a.hc("drop",function(e){return t.dropFiles(e)})("dragover",function(e){return t.onDragOver(e)})("dragenter",function(e){return t.onDragEnter(e)})("dragleave",function(e){return t.onDragLeave(e)}),a.Zb(1,"div",1),a.Zb(2,"input",2,3),a.hc("change",function(e){return t.uploadFiles(e)}),a.Yb(),a.Kc(4,d,2,2,"ng-template",null,4,a.Lc),a.Kc(6,b,0,0,"ng-template",5),a.Yb(),a.Yb()),2&e){var n=a.Ac(5);a.Lb("ngx-file-drop__drop-zone--over",t.isDraggingOverDropZone),a.tc("className",t.dropZoneClassName),a.Hb(1),a.tc("className",t.contentClassName),a.Hb(1),a.tc("accept",t.accept)("multiple",t.multiple),a.Ib("directory",t.directory||void 0)("webkitdirectory",t.directory||void 0)("mozdirectory",t.directory||void 0)("msdirectory",t.directory||void 0)("odirectory",t.directory||void 0),a.Hb(4),a.tc("ngTemplateOutlet",t.contentTemplate||n)("ngTemplateOutletContext",a.xc(13,m,t.openFileSelector))}},directives:[s.r,s.m],styles:[".ngx-file-drop__drop-zone[_ngcontent-%COMP%]{height:100px;margin:auto;border:2px dotted #0782d0;border-radius:30px}.ngx-file-drop__drop-zone--over[_ngcontent-%COMP%]{background-color:rgba(147,147,147,.5)}.ngx-file-drop__content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100px;color:#0782d0}.ngx-file-drop__drop-zone-label[_ngcontent-%COMP%]{text-align:center}.ngx-file-drop__file-input[_ngcontent-%COMP%]{display:none}"]}),g([Object(a.w)(),v("design:type",String)],e.prototype,"accept",void 0),g([Object(a.w)(),v("design:type",Boolean)],e.prototype,"directory",void 0),g([Object(a.w)(),v("design:type",Boolean)],e.prototype,"multiple",void 0),g([Object(a.w)(),v("design:type",String)],e.prototype,"dropZoneLabel",void 0),g([Object(a.w)(),v("design:type",String)],e.prototype,"dropZoneClassName",void 0),g([Object(a.w)(),v("design:type",Boolean)],e.prototype,"useDragEnter",void 0),g([Object(a.w)(),v("design:type",String)],e.prototype,"contentClassName",void 0),g([Object(a.w)(),v("design:type",Boolean),v("design:paramtypes",[Boolean])],e.prototype,"disabled",null),g([Object(a.w)(),v("design:type",Boolean)],e.prototype,"showBrowseBtn",void 0),g([Object(a.w)(),v("design:type",String)],e.prototype,"browseBtnClassName",void 0),g([Object(a.w)(),v("design:type",String)],e.prototype,"browseBtnLabel",void 0),g([Object(a.G)(),v("design:type",a.q)],e.prototype,"onFileDrop",void 0),g([Object(a.G)(),v("design:type",a.q)],e.prototype,"onFileOver",void 0),g([Object(a.G)(),v("design:type",a.q)],e.prototype,"onFileLeave",void 0),g([Object(a.l)(h,{read:a.R}),v("design:type",a.R)],e.prototype,"contentTemplate",void 0),g([Object(a.V)("fileSelector",{static:!0}),v("design:type",a.n)],e.prototype,"fileSelector",void 0),e=g([v("design:paramtypes",[a.E,a.K])],e)}(),w=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Rb({type:e,bootstrap:function(){return[y]}}),e.\u0275inj=a.Qb({providers:[],imports:[[s.c]]}),e}()},pjD5:function(e,i,r){"use strict";r.r(i),r.d(i,"SubmitRequestModule",function(){return re});var a=r("3Pt+"),o=r("ofXK"),s=r("ADsi"),c=r("AKYE"),l=r("tyNb"),u=r("mrSG"),d=r("+0xr"),b=r("n3+I"),m=r("PLN7"),p=r("Q+/z"),f=r("AytR"),h=r("wHSu"),g=r("BF3V"),v=r("fXoL"),y=r("dNgK"),w=r("Wp6s"),D=r("Dh3D"),L=r("kmnG"),k=r("qFsG"),Z=r("gfTr"),F=r("6NWb"),M=r("bTqV"),O=r("/1cH"),x=r("FKr1"),Y=r("7FpO");function C(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Brand "),v.Yb())}function E(e,t){if(1&e&&(v.Zb(0,"mat-cell",39),v.Mc(1),v.Yb()),2&e){var n=t.$implicit;v.Hb(1),v.Oc(" ",n.brand," ")}}function T(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Model "),v.Yb())}function R(e,t){if(1&e&&(v.Zb(0,"mat-cell",40),v.Mc(1),v.Yb()),2&e){var n=t.$implicit;v.Hb(1),v.Oc(" ",n.model," ")}}function S(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Total "),v.Yb())}function _(e,t){if(1&e&&(v.Zb(0,"mat-cell",41),v.Mc(1),v.Yb()),2&e){var n=t.$implicit;v.Hb(1),v.Oc(" ",n.total," ")}}function B(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Change Model "),v.Yb())}function H(e,t){if(1&e&&(v.Zb(0,"mat-option",47),v.Mc(1),v.Yb()),2&e){var n=t.$implicit;v.tc("value",n.model),v.Hb(1),v.Oc(" ",n.model," ")}}function I(e,t){if(1&e){var n=v.ac();v.Zb(0,"mat-cell",42),v.Zb(1,"mat-form-field",24),v.Zb(2,"input",43,44),v.hc("ngModelChange",function(e){v.Dc(n);var i=t.index;return v.lc().submitLists[i].changed_model=e})("ngModelChange",function(e){v.Dc(n);var i=t.$implicit;return v.lc().findProduct(i.brandId,e)})("blur",function(){v.Dc(n);var e=t.$implicit,i=t.index,r=v.lc();return r.setIdByModelName(e.brandId,r.submitLists[i].changed_model,i,e.product_county)}),v.Yb(),v.Zb(4,"mat-autocomplete",null,45),v.Kc(6,H,2,2,"mat-option",46),v.Yb(),v.Yb(),v.Yb()}if(2&e){var i=t.index,r=v.Ac(5),a=v.lc();v.Hb(2),v.vc("id","changeModel",a.submitLists[i].id,""),v.vc("name","changeModel",a.submitLists[i].id,""),v.tc("ngModel",a.submitLists[i].changed_model)("matAutocomplete",r),v.Hb(4),v.tc("ngForOf",a.filteredProduct)}}function N(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Price "),v.Yb())}function P(e,t){if(1&e){var n=v.ac();v.Zb(0,"mat-cell"),v.Zb(1,"mat-form-field",24),v.Zb(2,"input",48,49),v.hc("ngModelChange",function(e){v.Dc(n);var i=t.index;return v.lc().submitLists[i].price=e}),v.Yb(),v.Yb(),v.Yb()}if(2&e){var i=t.index,r=v.lc();v.Hb(2),v.vc("id","price",r.submitLists[i].id,""),v.vc("name","price",r.submitLists[i].id,""),v.tc("ngModel",r.submitLists[i].price)("disabled","selected"==r.submitLists[i].sStatus)}}function j(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Currency "),v.Yb())}function K(e,t){if(1&e){var n=v.ac();v.Zb(0,"mat-cell"),v.Zb(1,"mat-form-field",24),v.Zb(2,"input",50,51),v.hc("ngModelChange",function(e){v.Dc(n);var i=t.index;return v.lc().submitLists[i].currency=e}),v.Yb(),v.Yb(),v.Yb()}if(2&e){var i=t.index,r=v.lc();v.Hb(2),v.vc("id","currency",r.submitLists[i].id,""),v.vc("name","currency",r.submitLists[i].id,""),v.tc("ngModel",r.submitLists[i].currency)("disabled",!0)}}function A(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Min Total "),v.Yb())}function q(e,t){if(1&e){var n=v.ac();v.Zb(0,"mat-cell"),v.Zb(1,"mat-form-field",24),v.Zb(2,"input",52,53),v.hc("ngModelChange",function(e){v.Dc(n);var i=t.index;return v.lc().submitLists[i].minTotal=e}),v.Yb(),v.Yb(),v.Yb()}if(2&e){var i=t.index,r=v.lc();v.Hb(2),v.vc("id","minTotal",r.submitLists[i].id,""),v.vc("name","minTotal",r.submitLists[i].id,""),v.tc("ngModel",r.submitLists[i].minTotal)("disabled","selected"==r.submitLists[i].sStatus)}}function z(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Local charge "),v.Yb())}function U(e,t){if(1&e){var n=v.ac();v.Zb(0,"mat-cell"),v.Zb(1,"mat-form-field",24),v.Zb(2,"input",54,55),v.hc("ngModelChange",function(e){v.Dc(n);var i=t.index;return v.lc().submitLists[i].local_charge=e}),v.Yb(),v.Yb(),v.Yb()}if(2&e){var i=t.index,r=v.lc();v.Hb(2),v.vc("id","local_charge",r.submitLists[i].id,""),v.vc("name","local_charge",r.submitLists[i].id,""),v.tc("ngModel",r.submitLists[i].local_charge)("disabled","selected"==r.submitLists[i].sStatus)}}function W(e,t){1&e&&(v.Zb(0,"mat-header-cell"),v.Mc(1," Send Days "),v.Yb())}function X(e,t){if(1&e){var n=v.ac();v.Zb(0,"mat-cell"),v.Zb(1,"mat-form-field",24),v.Zb(2,"input",56,57),v.hc("ngModelChange",function(e){v.Dc(n);var i=t.index;return v.lc().submitLists[i].sendDay=e}),v.Yb(),v.Yb(),v.Yb()}if(2&e){var i=t.index,r=v.lc();v.Hb(2),v.vc("id","sendDay",r.submitLists[i].id,""),v.vc("name","sendDay",r.submitLists[i].id,""),v.tc("ngModel",r.submitLists[i].sendDay)("disabled","selected"==r.submitLists[i].sStatus)}}function Q(e,t){1&e&&v.Ub(0,"mat-header-row")}function $(e,t){1&e&&v.Ub(0,"mat-row")}function G(e,t){if(1&e){var n=v.ac();v.Zb(0,"tr"),v.Zb(1,"td",33),v.Mc(2),v.Yb(),v.Zb(3,"td",34),v.Mc(4),v.Yb(),v.Zb(5,"td",35),v.Zb(6,"button",59),v.hc("click",function(){v.Dc(n);var e=v.lc().$implicit;return v.lc().downloadFile(e.id,e.original_name)}),v.Ub(7,"fa-icon",31),v.Yb(),v.Yb(),v.Zb(8,"td",35),v.Zb(9,"button",59),v.hc("click",function(){v.Dc(n);var e=v.lc().$implicit;return v.lc().removeFile(e.id)}),v.Ub(10,"fa-icon",31),v.Yb(),v.Yb(),v.Yb()}if(2&e){var i=v.lc().$implicit,r=v.lc();v.Hb(2),v.Nc(i.original_name),v.Hb(2),v.Nc("request"==i.type?"Requester":"supplier"==i.type?"Supplier":""),v.Hb(3),v.tc("icon",r.faDownload),v.Hb(3),v.tc("icon",r.faTrashAlt)}}function V(e,t){if(1&e&&(v.Xb(0),v.Kc(1,G,11,4,"tr",58),v.Wb()),2&e){var n=t.$implicit,i=v.lc();v.Hb(1),v.tc("ngIf","supplier"==n.type&&n.created_by==i.me)}}var J,ee,te,ne=[{path:"",component:(J=function(){function e(t,i,r,a,o){var s=this;n(this,e),this.api=t,this.root=i,this.route=r,this.snackBar=a,this.autoComProd=o,this.logo="../../../assets/logo/logo_y.png",this.faTrashAlt=h.p,this.faDownload=h.c,this.faPaperclip=h.i,this.linkUrl="",this.submitHead={sendDay:1,remark:""},this.submitLists=[],this.displayedColumns=["brand","model","total","changeModel","price","currency","minTotal","remark","sendDay"],this.cansave=!0,this.isOffer=!1,this.unsub={errorMessage:null},this.me=0,this.uploadAttachFileUrl=f.a.api+f.a.path+"/attach",this.attachFileList=[],this.fileUploadQueue=null,this.filteredProduct=[],this.unsub.errorMessage=this.root.apiError$.subscribe(function(e){return s.errorMessage=e})}return t(e,[{key:"ngOnInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.root.setHeaderText("SUBMIT FROM");case 2:if(this.linkUrl=this.route.snapshot.queryParamMap.get("l"),e.t0=this.linkUrl,!e.t0){e.next=7;break}return e.next=7,this.getSubmitData();case 7:case"end":return e.stop()}},e,this)}))}},{key:"getSubmitData",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.gets("/get-submit?link="+this.linkUrl).toPromise();case 2:if(t=e.sent,e.t0=t&&t.success,!e.t0){e.next=17;break}return this.me=t.supplier_id,this.submitHead.id=t.id,this.submitHead.remark=t.remark,this.submitHead.sendDay=t.send_day,this.submitHead.requestId=t.request_id,this.submitLists=t.submitList,this.attachFileList=t.files,t.currency&&this.submitLists.forEach(function(e,i){n.submitLists[i].currency=t.currency}),this.submitLists.forEach(function(e,t){parseInt(n.submitLists[t].sendDay,10)>=7&&(n.submitLists[t].sendDay=(parseInt(n.submitLists[t].sendDay,10)-7).toString())}),"0"===t.status&&(this.isOffer=!0),e.next=17,this.genSubmitTable();case 17:case"end":return e.stop()}},e,this)}))}},{key:"genSubmitTable",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.submitListTables=new d.k(this.submitLists);case 1:case"end":return e.stop()}},e,this)}))}},{key:"save",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.submitLists.forEach(function(e,t){i.submitLists[t].sendDay=(parseInt(i.submitLists[t].sendDay,10)+7).toString()}),t={id:this.submitHead.id,remark:this.submitHead.remark,requestId:this.submitHead.requestId,productList:this.submitLists,files:[]},this.attachFileList.length>0&&this.attachFileList.forEach(function(e){t.files.push(e.id)}),console.log(t),e.next=6,this.root.setBlockUI(!0);case 6:return e.next=8,this.api.post("/submit-request",t).toPromise();case 8:return n=e.sent,e.next=11,this.root.setBlockUI(!1);case 11:n&&n.success?(this.cansave=!1,this.isOffer=!0,this.snackBar.openFromComponent(p.a,{data:{message:"\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08",success:!0},duration:3e3}),this.submitLists.forEach(function(e,t){parseInt(i.submitLists[t].sendDay,10)>=7&&(i.submitLists[t].sendDay=(parseInt(i.submitLists[t].sendDay,10)-7).toString())})):this.snackBar.openFromComponent(p.a,{data:{message:"\u0e44\u0e21\u0e48\u0e2a\u0e32\u0e21\u0e32\u0e23\u0e16\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e44\u0e14\u0e49 "+this.errorMessage,error:!0},duration:3e3});case 12:case"end":return e.stop()}},e,this)}))}},{key:"saveFile",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.uploadFileFetch(e,"supplier",this.me);case 2:return n=t.sent,t.abrupt("return",!(!n||!n.status||"success"!==n.status||(this.attachFileList.push(n),console.log(this.attachFileList),0)));case 4:case"end":return t.stop()}},t,this)}))}},{key:"fileOver",value:function(e){}},{key:"fileLeave",value:function(e){}},{key:"uploadedFile",value:function(e){var t=this,n=e;console.log(n),n.forEach(function(e){e.fileEntry.isFile&&e.fileEntry.file(function(e){return Object(u.a)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveFile(e);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}this.snackBar.openFromComponent(p.a,{data:{message:"\u0e41\u0e19\u0e1a\u0e44\u0e1f\u0e25\u0e4c\u0e44\u0e21\u0e48\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08",warning:!0},duration:3e3});case 5:case"end":return t.stop()}},t,this)}))})})}},{key:"removeFile",value:function(e){this.attachFileList.length>0&&(this.attachFileList=this.attachFileList.filter(function(t,n){return t.id!==e})),console.log(this.attachFileList)}},{key:"downloadFile",value:function(e,t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.api.download("/downloadfile?id="+e).toPromise();case 2:return i=n.sent,n.next=5,this.downLoadNewFile(i,i.type,t);case 5:case"end":return n.stop()}},n,this)}))}},{key:"downLoadNewFile",value:function(e,t,n){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new Blob([e],{type:t}),i.next=3,window.URL.createObjectURL(r);case 3:a=i.sent,(o=document.createElement("a")).href=a,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o);case 6:case"end":return i.stop()}},i)}))}},{key:"closeWindows",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=window.open("","_self",""),setTimeout(function(){t.close(),console.log("fff")},3e3);case 2:case"end":return e.stop()}},e)}))}},{key:"findProduct",value:function(e,t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.autoComProd.findProductWithBrandId(e,t,function(e){i.filteredProduct=e});case 1:case"end":return n.stop()}},n,this)}))}},{key:"setIdByModelName",value:function(e,t,n,i){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null==t&&""===t){r.next=12;break}return r.next=3,this.api.get("/get-product-byid?brand="+e+"&model="+t).toPromise();case 3:if(!(a=r.sent)||!a.id){r.next=8;break}this.submitLists[n].changed_id=a.id,this.submitLists[n].is_changed="1",r.next=10;break;case 8:return r.next=10,this.updateNewProductBySupplier(t,e,i,n);case 10:r.next=13;break;case 12:this.submitLists[n].changed_id=0,this.submitLists[n].is_changed="0";case 13:case"end":return r.stop()}},r,this)}))}},{key:"updateNewProductBySupplier",value:function(e,t,n,i){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={model:e,brandId:t,county:n},r.next=3,this.api.post("/update-product-bysupplier",a).toPromise();case 3:(o=r.sent)&&o.success?(this.submitLists[i].changed_id=o.id,this.submitLists[i].is_changed="1"):(this.submitLists[i].changed_id=0,this.submitLists[i].is_changed="1",this.submitLists[i].changed_model=null);case 5:case"end":return r.stop()}},r,this)}))}},{key:"ngOnDestroy",value:function(){this.unsub.errorMessage.unsubscribe()}}]),e}(),J.\u0275fac=function(e){return new(e||J)(v.Tb(m.a),v.Tb(b.a),v.Tb(l.a),v.Tb(y.b),v.Tb(g.a))},J.\u0275cmp=v.Nb({type:J,selectors:[["app-submit-request"]],decls:79,vars:9,consts:[[1,"w3-container"],[1,"row"],[1,"w3-col","w3-padding"],["height","80",3,"src"],["supplierSubmitForm","ngForm"],[1,"w3-row"],["matSort","",3,"dataSource"],["matColumnDef","brand"],[4,"matHeaderCellDef"],["data-label","Brand",4,"matCellDef"],["matColumnDef","model"],["data-label","Model",4,"matCellDef"],["matColumnDef","total"],["data-label","Total",4,"matCellDef"],["matColumnDef","changeModel"],["data-label","Change Model",4,"matCellDef"],["matColumnDef","price"],[4,"matCellDef"],["matColumnDef","currency"],["matColumnDef","minTotal"],["matColumnDef","remark"],["matColumnDef","sendDay"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"w3-block","w3-padding"],["matInput","","placeholder","Remark","id","remark","name","remark",3,"ngModel","ngModelChange"],["remark","ngModel"],[1,"w3-third"],[2,"color","#2189d3","margin-left","16px"],["dropZoneLabel","Drop files here or ","browseBtnClassName","w3-button w3-round-large brow-file-bt",3,"showBrowseBtn","onFileDrop","onFileOver","onFileLeave"],[2,"font-size","20px","padding-right","8px"],[3,"icon"],[1,"w3-table-all",2,"margin-top","16px"],[1,"w3-col","s6","m9","l9"],[1,"w3-col","s2","m1","l1"],[1,"w3-col","s2","m1","l1","w3-center"],[4,"ngFor","ngForOf"],[1,"w3-col","w3-center"],["mat-raised-button","","color","accent",1,"w3-center",2,"margin-right","8px",3,"disabled","click"],["data-label","Brand"],["data-label","Model"],["data-label","Total"],["data-label","Change Model"],["matInput","","placeholder","Change Model",3,"id","name","ngModel","matAutocomplete","ngModelChange","blur"],["changeModel{{submitLists[i].id}}","ngModel"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matInput","","appOnlyNum","","placeholder","Price","required","",3,"id","name","ngModel","disabled","ngModelChange"],["price{{submitLists[i].id}}","ngModel"],["matInput","","placeholder","Currency","required","",3,"id","name","ngModel","disabled","ngModelChange"],["currency{{submitLists[i].id}}","ngModel"],["matInput","","placeholder","Min Total","required","",3,"id","name","ngModel","disabled","ngModelChange"],["minTotal{{submitLists[i].id}}","ngModel"],["matInput","","appOnlyNum","","placeholder","Local charge",3,"id","name","ngModel","disabled","ngModelChange"],["local_charge{{submitLists[i].id}}","ngModel"],["matInput","","appOnlyNum","","placeholder","Send Days","required","",3,"id","name","ngModel","disabled","ngModelChange"],["sendDay{{submitLists[i].id}}","ngModel"],[4,"ngIf"],[1,"w3-button",2,"background","none","height","21px","padding","0px !important",3,"click"]],template:function(e,t){if(1&e&&(v.Ub(0,"br"),v.Zb(1,"div"),v.Zb(2,"mat-card"),v.Zb(3,"div",0),v.Zb(4,"div",1),v.Zb(5,"div",2),v.Ub(6,"img",3),v.Yb(),v.Yb(),v.Zb(7,"div",1),v.Zb(8,"div",2),v.Zb(9,"h6"),v.Mc(10,"No.88/5 Thanon Nang Linchi, Khwaeng Chong Nonsi, Khet Yan Nawa, Krung Thep Maha Nakhon 10120"),v.Yb(),v.Yb(),v.Yb(),v.Yb(),v.Zb(11,"form",null,4),v.Zb(13,"div",5),v.Zb(14,"mat-table",6),v.Xb(15,7),v.Kc(16,C,2,0,"mat-header-cell",8),v.Kc(17,E,2,1,"mat-cell",9),v.Wb(),v.Xb(18,10),v.Kc(19,T,2,0,"mat-header-cell",8),v.Kc(20,R,2,1,"mat-cell",11),v.Wb(),v.Xb(21,12),v.Kc(22,S,2,0,"mat-header-cell",8),v.Kc(23,_,2,1,"mat-cell",13),v.Wb(),v.Xb(24,14),v.Kc(25,B,2,0,"mat-header-cell",8),v.Kc(26,I,7,5,"mat-cell",15),v.Wb(),v.Xb(27,16),v.Kc(28,N,2,0,"mat-header-cell",8),v.Kc(29,P,4,4,"mat-cell",17),v.Wb(),v.Xb(30,18),v.Kc(31,j,2,0,"mat-header-cell",8),v.Kc(32,K,4,4,"mat-cell",17),v.Wb(),v.Xb(33,19),v.Kc(34,A,2,0,"mat-header-cell",8),v.Kc(35,q,4,4,"mat-cell",17),v.Wb(),v.Xb(36,20),v.Kc(37,z,2,0,"mat-header-cell",8),v.Kc(38,U,4,4,"mat-cell",17),v.Wb(),v.Xb(39,21),v.Kc(40,W,2,0,"mat-header-cell",8),v.Kc(41,X,4,4,"mat-cell",17),v.Wb(),v.Kc(42,Q,1,0,"mat-header-row",22),v.Kc(43,$,1,0,"mat-row",23),v.Yb(),v.Yb(),v.Zb(44,"div",5),v.Zb(45,"div",2),v.Zb(46,"mat-form-field",24),v.Zb(47,"textarea",25,26),v.hc("ngModelChange",function(e){return t.submitHead.remark=e}),v.Yb(),v.Yb(),v.Yb(),v.Yb(),v.Yb(),v.Ub(49,"br"),v.Zb(50,"div",5),v.Zb(51,"div",27),v.Mc(52,"\xa0"),v.Yb(),v.Zb(53,"div",27),v.Zb(54,"label",28),v.Mc(55,"Attach File"),v.Yb(),v.Zb(56,"ngx-file-drop",29),v.hc("onFileDrop",function(e){return t.uploadedFile(e)})("onFileOver",function(e){return t.fileOver(e)})("onFileLeave",function(e){return t.fileLeave(e)}),v.Zb(57,"span",30),v.Ub(58,"fa-icon",31),v.Yb(),v.Yb(),v.Yb(),v.Zb(59,"div",27),v.Mc(60,"\xa0"),v.Yb(),v.Yb(),v.Ub(61,"br"),v.Zb(62,"div",5),v.Zb(63,"table",32),v.Zb(64,"tr"),v.Zb(65,"th",33),v.Mc(66,"File Name"),v.Yb(),v.Zb(67,"th",34),v.Mc(68,"File From"),v.Yb(),v.Zb(69,"th",35),v.Mc(70,"Download"),v.Yb(),v.Zb(71,"th",35),v.Mc(72,"Delete"),v.Yb(),v.Yb(),v.Kc(73,V,2,1,"ng-container",36),v.Yb(),v.Yb(),v.Ub(74,"br"),v.Zb(75,"div",5),v.Zb(76,"div",37),v.Zb(77,"button",38),v.hc("click",function(){return t.save()}),v.Mc(78," Save "),v.Yb(),v.Yb(),v.Yb(),v.Yb(),v.Yb()),2&e){var n=v.Ac(12);v.Hb(6),v.tc("src",t.logo,v.Fc),v.Hb(8),v.tc("dataSource",t.submitListTables),v.Hb(28),v.tc("matHeaderRowDef",t.displayedColumns),v.Hb(1),v.tc("matRowDefColumns",t.displayedColumns),v.Hb(4),v.tc("ngModel",t.submitHead.remark),v.Hb(9),v.tc("showBrowseBtn",!0),v.Hb(2),v.tc("icon",t.faPaperclip),v.Hb(15),v.tc("ngForOf",t.attachFileList),v.Hb(4),v.tc("disabled",n.invalid)}},directives:[w.a,a.x,a.o,a.p,d.j,D.a,d.c,d.e,d.b,d.g,d.i,L.c,k.b,a.c,a.n,a.q,Z.a,F.a,o.l,M.b,d.d,d.a,O.c,O.a,x.n,Y.a,a.u,d.f,d.h,o.m],styles:[""]}),J)}],ie=((te=function e(){n(this,e)}).\u0275fac=function(e){return new(e||te)},te.\u0275mod=v.Rb({type:te}),te.\u0275inj=v.Qb({imports:[[l.f.forChild(ne)],l.f]}),te),re=((ee=function e(){n(this,e)}).\u0275fac=function(e){return new(e||ee)},ee.\u0275mod=v.Rb({type:ee}),ee.\u0275inj=v.Qb({imports:[[o.c,a.i,ie,s.a,c.a,Z.b]]}),ee)}}])}();